{"componentChunkName":"component---src-templates-blog-post-js","path":"/others/Boxing과-Unboxing/","result":{"data":{"site":{"siteMetadata":{"title":"10cheon00의 Archive"}},"markdownRemark":{"id":"1b34984d-6302-5e68-83c7-31c6a15b94aa","excerpt":"Boxing…","html":"<h1 id=\"boxing\" style=\"position:relative;\"><a href=\"#boxing\" aria-label=\"boxing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" width=\"16\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>Boxing</h1>\n<p>값 형식을 <code class=\"language-text\">object</code>형식 또는 이 값 형식에서 구현된 임의의 인터페이스 형식으로 변환하는 프로세스라고 한다.</p>\n<p>전자는 <code class=\"language-text\">int</code>나 <code class=\"language-text\">float</code>같은 값 형식을 <code class=\"language-text\">object</code>형식으로 바꾸는 것을 말하고 후자는 <code class=\"language-text\">struct</code>를 <code class=\"language-text\">interface</code>로 다룰 때를 의미한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> n <span class=\"token operator\">=</span> <span class=\"token number\">123</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">object</span></span> o <span class=\"token operator\">=</span> n<span class=\"token punctuation\">;</span> <span class=\"token comment\">// boxing</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">ITest</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">DoSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">struct</span> <span class=\"token class-name\">MyTest</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">ITest</span></span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">DoSomething</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// do something</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token class-name\"><span class=\"token keyword\">var</span></span> myTest <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">MyTest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">var</span></span> myTestAsITest <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>ITest<span class=\"token punctuation\">)</span>myTest<span class=\"token punctuation\">;</span> <span class=\"token comment\">// boxing</span></code></pre></div>\n<p>값 형식과 다르게 <code class=\"language-text\">object</code>는 참조 형식이므로 실제 데이터는 힙 영역에 저장된다. 그렇기 때문에 값 형식에서 참조 형식 즉, <code class=\"language-text\">object</code>로 boxing하게 되면 <strong>스택에 있던 데이터가 복사되어 힙에 생성된다</strong>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 228px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/be6b45688924fcf779126429c7a7fac6/d4770/image.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.18987341772153%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAACKklEQVR42oVQXW/SYBjt3zN+xkViVPAju/ALE+MViV7sRhMvjVmM2Y0mi4mBYWCyUtgYIwxbigPKqg0tCIWWwmgHLxYo74cBzMQL3XP1POd9zvucc6hIJCKKIk3TyWSS4ziGYba2thRFIYQghDDGhBCe51mWzefzoVBIFEWGYWKxmCRJFAAD27bBYGAd9wAAlmWZpjkajgghcyYhBABgmma/39d1HQBgGEatVrMsi2o0mhiTiQMxxhAiCBFGvzmnFnUYeGAmH1U+3xP8y/WoV4/e+b6zOmVjdLKEF2oRoeohD8p4GmGXsH7RjLtHiaXY2sO+jRZl//NyiU8qJbZ6yMnFtMDt6JVCv6vNPz9ddl1tmse9zpGp6UZN1cZj5z83F5VPyWRubwrh2SvEC27JDIUQwokzpyE0HWYwofjcwQSSsYPGDh6NEYIO/jsqQkihWMrmCuFNOh5P+APBDJsbO9MdqrjxuJPytXZ9RtLXTj0V6BWJ2xhOCPg5GNh2D/SNni2l3qn0fSXi5T8sC4G7DcZbZZ7ZA0Cp4RuE8zhpt5O+Dr/cLkWfhNdXZK2jtluqYVSaDV6uy7uvRonLw5Rb+nipFXGhzDV181Zb1yiB3RYy9LfstlxISV8TP/IxS5P/pD2zoOytmvRSh3GX/VcqQZe9d5NbO//yxXOqrFRLolSp1vWW0Wp320fWZAJPgkVo2pcTr7Xgudon1/7bM8X3F7rRq/tvzh7ksr8A40GuYtdctokAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Alt text\"\n        title=\"\"\n        src=\"/static/be6b45688924fcf779126429c7a7fac6/d4770/image.png\"\n        srcset=\"/static/be6b45688924fcf779126429c7a7fac6/c26ae/image.png 158w,\n/static/be6b45688924fcf779126429c7a7fac6/d4770/image.png 228w\"\n        sizes=\"(max-width: 228px) 100vw, 228px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>그림으로 보면 이렇다.</p>\n<h1 id=\"unboxing\" style=\"position:relative;\"><a href=\"#unboxing\" aria-label=\"unboxing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" width=\"16\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>Unboxing</h1>\n<p>boxing을 통해 힙 영역에 생성된 데이터를 다시 원래의 값 형식으로 돌리려고 할 때, Unboxing이 일어난다.</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> n <span class=\"token operator\">=</span> <span class=\"token number\">123</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">object</span></span> o <span class=\"token operator\">=</span> n<span class=\"token punctuation\">;</span> <span class=\"token comment\">// boxing</span>\n<span class=\"token class-name\"><span class=\"token keyword\">int</span></span> t <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>o<span class=\"token punctuation\">;</span> <span class=\"token comment\">// unboxing</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token class-name\"><span class=\"token keyword\">var</span></span> myTest <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">MyTest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">var</span></span> myTestAsITest <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>ITest<span class=\"token punctuation\">)</span>myTest<span class=\"token punctuation\">;</span> <span class=\"token comment\">// boxing</span>\n<span class=\"token class-name\"><span class=\"token keyword\">var</span></span> myTestUnboxing <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>MyTest<span class=\"token punctuation\">)</span>myTestAsITest<span class=\"token punctuation\">;</span> <span class=\"token comment\">// unboxing</span></code></pre></div>\n<p>이 과정에서 <code class=\"language-text\">object</code>가 가리키는 데이터는 무조건 <strong>boxing으로 생성된 데이터여야 한다</strong>. 그렇지 않으면 <code class=\"language-text\">InvalidCastException</code>에러가 발생한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> n <span class=\"token operator\">=</span> <span class=\"token number\">123</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">object</span></span> o <span class=\"token operator\">=</span> n<span class=\"token punctuation\">;</span> <span class=\"token comment\">// boxing</span>\n<span class=\"token class-name\"><span class=\"token keyword\">int</span></span> t <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">short</span><span class=\"token punctuation\">)</span>o<span class=\"token punctuation\">;</span> <span class=\"token comment\">// InvalidCastException occured.</span></code></pre></div>\n<p>어떻게 보면 <code class=\"language-text\">short</code>형 값을 <code class=\"language-text\">int</code>형 변수에 대입하는 것이라고 볼 수 있겠지만, boxing을 통해 생성된 데이터를 unboxing하려면 항상 원래의 형식으로 변환해야한다.</p>\n<h1 id=\"주의할-점\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9D%98%ED%95%A0-%EC%A0%90\" aria-label=\"주의할 점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" width=\"16\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>주의할 점</h1>\n<p>데이터를 복사하여야 하므로 그 과정이 매우 오래걸린다고 한다...</p>\n<h1 id=\"참고자료\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\" aria-label=\"참고자료 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" width=\"16\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>참고자료</h1>\n<p><a href=\"https://learn.microsoft.com/ko-kr/dotnet/csharp/programming-guide/types/boxing-and-unboxing\">Boxing 및 Unboxing(C# 프로그래밍 가이드) | Microsoft Learn</a></p>","frontmatter":{"title":"Boxing과 Unboxing","date":"August 10, 2023","description":null,"tags":["csharp"]}},"previous":{"fields":{"slug":"/design-patterns/상태-패턴/"},"frontmatter":{"title":"상태 패턴"}},"next":{"fields":{"slug":"/others/Csharp의-형변환/"},"frontmatter":{"title":"Csharp의 형변환"}}},"pageContext":{"id":"1b34984d-6302-5e68-83c7-31c6a15b94aa","previousPostId":"d780ce4c-c3e2-5b50-b3d2-28e546f8bc4a","nextPostId":"8b7e626a-2a29-523f-b0e6-e2c2eaa1ff26"}},"staticQueryHashes":["230163734","3589320610"],"slicesMap":{}}