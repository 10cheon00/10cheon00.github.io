{"componentChunkName":"component---src-templates-blog-post-js","path":"/posts/Gatsby-목차-사이드바-만들기/","result":{"data":{"site":{"siteMetadata":{"title":"10cheon00의 Archive"}},"markdownRemark":{"id":"37fe296b-6720-5d06-9b54-4e2d9b6f98f8","excerpt":"동기 velog…","html":"<h1 id=\"동기\" style=\"position:relative;\"><a href=\"#%EB%8F%99%EA%B8%B0\" aria-label=\"동기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" width=\"16\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>동기</h1>\n<p>velog를 보면 게시글 오른쪽에 목차 사이드바가 떠있다. 간단한 기능이지만 긴 게시물의 경우 굳이 스크롤로 이동하지 않고 사이드바의 링크를 클릭해서 게시글을 이동할 수 있으니 꽤 좋은 기능이다.</p>\n<p>이런 플러그인을 찾기는 어려울 것 같아서 직접 만들어보기로 했다.</p>\n<h1 id=\"tableofcontents-쿼리\" style=\"position:relative;\"><a href=\"#tableofcontents-%EC%BF%BC%EB%A6%AC\" aria-label=\"tableofcontents 쿼리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" width=\"16\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>tableOfContents 쿼리</h1>\n<p>게시물마다 목차만 추출해오기 위해서 <a href=\"https://soopdop.github.io/2020/12/03/add-table-of-content-gatsby/\">Gatsby Blog에 목차 추가하기 | Harry Park's Blog</a>를 참고했다.</p>\n<p>graphql을 이용해서 이미 만들어져 있는 목차 데이터를 갖고 올 수 있다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// gatsby-node.js</span>\n\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">createPages</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> graphql<span class=\"token punctuation\">,</span> actions<span class=\"token punctuation\">,</span> reporter <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createPage<span class=\"token punctuation\">,</span> createRedirect <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> actions\n\n  <span class=\"token comment\">// Get all markdown blog posts sorted by date</span>\n  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">graphql</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    {\n      allMarkdownRemark(sort: { frontmatter: { date: ASC } }, limit: 1000) {\n        nodes {\n          id\n          fields {\n            slug\n          }\n          frontmatter {\n            tags\n          }\n          tableOfContents\n        }\n      }\n    }\n  </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token operator\">...</span></code></pre></div>\n<p>이렇게 쿼리문을 작성하고 <code class=\"language-text\">localhost:8000/__graphql</code>로 접속해서 실행해보면 아래처럼 결과를 얻게 된다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"data\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"allMarkdownRemark\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"nodes\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"5611776e-48ff-5ad2-b058-ddd2071068d1\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"fields\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"slug\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/posts/Gatsby-사이트-구축기/\"</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"frontmatter\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"tags\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n              <span class=\"token string\">\"gatsby\"</span><span class=\"token punctuation\">,</span>\n              <span class=\"token string\">\"blog\"</span>\n            <span class=\"token punctuation\">]</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"tableOfContents\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;ul>\\n&lt;li>&lt;a href=\\\"#gatsby%EB%A5%BC-%EC%84%A0%ED%83%9D%ED%95%9C-%EC%9D%B4%EC%9C%A0\\\">Gatsby를 선택한 이유&lt;/a>&lt;/li>\\n&lt;li>&lt;a href=\\\"#%EC%84%A4%EC%B9%98\\\">설치&lt;/a>&lt;/li>\\n&lt;li>&lt;a href=\\\"#fatal-couldnt-find-remote-ref-refsheadsmain\\\">fatal: Couldn't find remote ref refs/heads/main&lt;/a>&lt;/li>\\n&lt;li>&lt;a href=\\\"#%ED%83%9C%EA%B7%B8-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0\\\">태그 추가하기&lt;/a>&lt;/li>\\n&lt;li>&lt;a href=\\\"#todo\\\">TODO&lt;/a>&lt;/li>\\n&lt;/ul>\"</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n        ...\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 블로그는 <code class=\"language-text\">gatsby-starter-blog</code>로 제작되어서 <code class=\"language-text\">tableOfContents</code>가 html을 반환한다. a태그가 리스트에 담겨있는 형태이므로 이걸 렌더링한뒤 css로 꾸미기만 하면 된다.</p>\n<h1 id=\"컴포넌트-제작\" style=\"position:relative;\"><a href=\"#%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EC%A0%9C%EC%9E%91\" aria-label=\"컴포넌트 제작 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" width=\"16\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>컴포넌트 제작</h1>\n<p>게시물 페이지에서만 목차 컴포넌트를 렌더링해야한다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// src/components/table-of-contents.js</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TableOfContents</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">\"table-of-contents-layout\"</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div\n          className<span class=\"token operator\">=</span><span class=\"token string\">\"table-of-contents\"</span>\n          dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">__html</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>tableOfContents <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> TableOfContents</code></pre></div>\n<p>게시물 컴포넌트안에서 목차 컴포넌트가 등장해야하므로 아까 쿼리문으로 얻어낸 <code class=\"language-text\">tableOfContents</code>를 전달받아 그대로 렌더링한다.</p>\n<p>이 때 전달받은 값이 raw html이므로 <code class=\"language-text\">dangerouslySetInnerHTML</code> 속성에 전달한다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// src/templates/blog-post.js</span>\n\n<span class=\"token operator\">...</span>\n<span class=\"token keyword\">import</span> TableOfContents <span class=\"token keyword\">from</span> <span class=\"token string\">\"../components/table-of-contents\"</span>\n<span class=\"token operator\">...</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">BlogPostTemplate</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> previous<span class=\"token punctuation\">,</span> next<span class=\"token punctuation\">,</span> site<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">markdownRemark</span><span class=\"token operator\">:</span> post <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  location<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> siteTitle <span class=\"token operator\">=</span> site<span class=\"token punctuation\">.</span>siteMetadata<span class=\"token operator\">?.</span>title <span class=\"token operator\">||</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Title</span><span class=\"token template-punctuation string\">`</span></span>\n  <span class=\"token keyword\">const</span> tableOfContents <span class=\"token operator\">=</span> post<span class=\"token punctuation\">.</span>tableOfContents\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Layout location<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>location<span class=\"token punctuation\">}</span> title<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>siteTitle<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>article\n        className<span class=\"token operator\">=</span><span class=\"token string\">\"blog-post\"</span>\n        itemScope\n        itemType<span class=\"token operator\">=</span><span class=\"token string\">\"http://schema.org/Article\"</span>\n      <span class=\"token operator\">></span>\n        <span class=\"token operator\">...</span>\n        <span class=\"token operator\">&lt;</span>TableOfContents\n          tableOfContents<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>tableOfContents<span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>section\n          dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">__html</span><span class=\"token operator\">:</span> post<span class=\"token punctuation\">.</span>html <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          itemProp<span class=\"token operator\">=</span><span class=\"token string\">\"articleBody\"</span>\n        <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">...</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>article<span class=\"token operator\">></span>\n      <span class=\"token operator\">...</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Layout<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>게시물 컴포넌트에서는 아까 만들어둔 <code class=\"language-text\">TableOfContents</code> 컴포넌트를 불러온 다음 graphql에서 얻은 데이터를 넣어주기만 하면 된다.</p>\n<h1 id=\"꾸미기\" style=\"position:relative;\"><a href=\"#%EA%BE%B8%EB%AF%B8%EA%B8%B0\" aria-label=\"꾸미기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" width=\"16\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>꾸미기</h1>\n<p>여기까지 한다면 게시물에 목차가 드러난다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cbacbf8e343d4f3e4506f6c7a8ac06a1/27524/image.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100.63291139240506%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADR0lEQVR42p2UWW8bVRTHjZTV9ixeZp/xzHgZezzeYid23KykcUlSkTQpldikCl6qRkiRoAUixCaQeOKFbwBf9Id8HaOgEqTm4a9z77nn/u+5Z0u1+5sk3XWStRHt/gjLLbO1/4iN8R5hrUU17uCV62zuPKTW7OEGEd3BmDBq0d3YYvfghLOnHxE1O6xk86QuPnzO6+sfeHH1Na+/+5mLZx+zvX/Eiy++4vLqGy6vXvHe41P2J6d8ef0Tv/3+B99+/wuffvaSrf1Dnn3yOdc//srW7gELKzKp8f4RW+8e8s7CKnLBQjN9VqWCeG2OtDzbq0VbeJ3THJbSKmmpQFouspzJkVE0pJxBygka+NWmOMjmdNJqESlvIOfNN5BVdVazeSHnOilnCqI5UprlYLieiJ1lV3DtKkXNFZduG84xIzHuRCqq7dBN3qfeH1JebxE9HGMlDTLy1NP/v/yfhJvNV5yP/mTw5Jy1l5vs/HVJ/fkB6WUVuXAPwpxuI1tVJD1GNtrIxQRZb6KYzbcmE4Rq0UHWa8hmA0kLkPLWDAXnvoQ2il5BnnpULCHlHaS8i6Rq9yOc1k+uaKHabRSnh2wlKHYPuWAj5fS3J8zmDHKai2K3UOwOipWguusodluQyrdqcl42d2FGqGrkNRvV7pA1umS0iEzeJ1Mok1YMUT7pW8goc6n9Sy8aQ9VJZQslsoUA2Yyxyj0sP8JyfSwvxC5VsLwKVqmK6d2sb2A4ZSyvjOPXxLkbRuSKNikr7BLEY+rdHaK4jeNX8cIGQS0hqMZ4YZ2gmuBXYrxyg1K5QVBtChsvjETbliqx0E17PKUWTIqmi2H7wu3FFZmFZUlgaVWZ7VckltIKi6uzs8UV6eab2ptf7g93OXp8wdHpU9bHe4x3J0yOz5kcn9Ef7nDw6JSTsw/EPHywN+Hw+AmTk3OUu5Iy3D6gP9ymMxgzGO3S6o3oDh6wtTeh2uiSdDfo9MfU4i5xeyDskt7on+kzHyJCqgYp3Q5FnAw3pFLvCHjlWEjbnwV7GisniLBvEqI7oXhgCjeo4/gRYS1BtwNScWdAa21I3O5Tqbcx3QrmNHtBRMHw0CyfolkS6ymKli90831ed0UypnLadX8DFU0fapfk49sAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Alt text\"\n        title=\"\"\n        src=\"/static/cbacbf8e343d4f3e4506f6c7a8ac06a1/f058b/image.png\"\n        srcset=\"/static/cbacbf8e343d4f3e4506f6c7a8ac06a1/c26ae/image.png 158w,\n/static/cbacbf8e343d4f3e4506f6c7a8ac06a1/6bdcf/image.png 315w,\n/static/cbacbf8e343d4f3e4506f6c7a8ac06a1/f058b/image.png 630w,\n/static/cbacbf8e343d4f3e4506f6c7a8ac06a1/27524/image.png 646w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>css로 알차게 꾸며주면 된다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token atrule\"><span class=\"token rule\">@media</span> screen <span class=\"token keyword\">and</span> <span class=\"token punctuation\">(</span><span class=\"token property\">max-width</span><span class=\"token punctuation\">:</span> 1440px<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">.table-of-contents</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.table-of-contents-layout</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> sticky<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">top</span><span class=\"token punctuation\">:</span> 150px<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.table-of-contents</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> absolute<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">left</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.table-of-contents > ul</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 0 0 0 <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--spacing-6<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">max-width</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--maxWidth-xs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--maxWidth-xs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border-left</span><span class=\"token punctuation\">:</span> 2px solid <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--color-blockquote<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.table-of-contents ul</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">padding-left</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--spacing-4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">list-style-type</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.table-of-contents a</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">text-decoration</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--color-blockquote<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--fontSize-0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.table-of-contents a.active</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--color-text<span class=\"token punctuation\">)</span> <span class=\"token important\">!important</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">font-weight</span><span class=\"token punctuation\">:</span> <span class=\"token function\">var</span><span class=\"token punctuation\">(</span>--fontWeight-bold<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\">.table-of-contents p</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>목차 레이아웃은 <code class=\"language-text\">position: sticky</code>속성을 주고 그 안에 목차 요소를 배치한다.</p>\n<p>목차 요소는 <code class=\"language-text\">position: absolute</code>에 <code class=\"language-text\">left: 100%</code>로 <code class=\"language-text\">sticky</code>로 정해진 레이아웃 요소의 오른쪽에 배치되도록 한다.</p>\n<h1 id=\"현재-읽고-있는-내용-하이라이트-하기\" style=\"position:relative;\"><a href=\"#%ED%98%84%EC%9E%AC-%EC%9D%BD%EA%B3%A0-%EC%9E%88%EB%8A%94-%EB%82%B4%EC%9A%A9-%ED%95%98%EC%9D%B4%EB%9D%BC%EC%9D%B4%ED%8A%B8-%ED%95%98%EA%B8%B0\" aria-label=\"현재 읽고 있는 내용 하이라이트 하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" width=\"16\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>현재 읽고 있는 내용 하이라이트 하기</h1>\n<p>스크롤 될 때마다 현재 어느 목차를 읽고 있는지 확인해야 하므로 <code class=\"language-text\">onScroll</code>이벤트리스너를 추가하여야 한다.</p>\n<p>컴포넌트가 마운트될 때 이벤트 리스너를 추가하고, 언마운트될 때 리스너를 삭제한다.</p>\n<p>그리고 DOM에 있는 목차요소들(<code class=\"language-text\">h1</code>, <code class=\"language-text\">h2</code>, <code class=\"language-text\">h3</code>)의 y좌표가 0보다 작은지 검사하고 가장 0과 가까운 y좌표를 가진 요소를 하이라이트 하도록 했다.</p>\n<p>하이라이트는 단순하게 <code class=\"language-text\">classList=\"active\"</code>처럼 클래스 이름으로 css를 다르게 적용하는 방법을 사용했다.</p>\n\n          <div class=\"gatsby-remark-prismjs-copy-button-container\">\n            <div class=\"gatsby-remark-prismjs-copy-button\" tabindex=\"0\" role=\"button\" aria-pressed=\"false\" onclick=\"gatsbyRemarkCopyToClipboard(this, this.parentNode.nextElementSibling)\">\n              Copy\n            </div>\n          </div>\n          \n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// src/components/table-of-contents.js</span>\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TableOfContents</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"scroll\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>updateTableOfContents<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">updateTableOfContents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> headers <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n      section[itemProp=\"articleBody\"] h1,\n      section[itemProp=\"articleBody\"] h2,\n      section[itemProp=\"articleBody\"] h3\n    </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> links <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">div.table-of-contents a</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> currentHeader <span class=\"token operator\">=</span> Array<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>headers<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> pos <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">getBoundingClientRect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> pos<span class=\"token punctuation\">.</span>y <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    links<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">===</span> currentHeader<span class=\"token operator\">?.</span>textContent<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        e<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> <span class=\"token string\">\"active\"</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        e<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"scroll\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>updateTableOfContents<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">\"table-of-contents-layout\"</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div\n          className<span class=\"token operator\">=</span><span class=\"token string\">\"table-of-contents\"</span>\n          dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">__html</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>tableOfContents <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> TableOfContents</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 375px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5955795ad6824d3c177659ac0794b4c8/5ff7e/image-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.79746835443038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACJ0lEQVR42o2SO28aURBGKaLIDyCYfV32wb53WdjFC3IwQoljsA0kjm0liptU6dKkcpMqv/1E92LFdpfi052ZK42+OTON++8/ePj9hyAZ8vqgQ7NjcvjGfHyN/1LryPqnhnBj3CDDsgM0y9vJdDkyXRXrwkMTHt3nubXLddFHs/q0u+KpYTF6S1XPSfMxSTYmLmqipCDMK5KsIhkck41rwrwkKcbko5p8NFF/w/GMrJi+bBgPjkkGFV3Lw7B9TNvHckKEG6rcciLMXoBlh5g9H6PXx3RDTCfAtAPl8sXI9fyM+dkls8U55fSEJC+J05JsVBMNSqKsIkxKorQkjAuitCAsKsJ8pNz78UA1Em6knDbiYU1a1CR5jd1PsNwQ4cU7R06oGMnXED6WFynX0r3l+JhugPAixVzuQrpt1KfvqE8XzBYrzldrqskJWTklLcaKWZBIJxPitCKrJspZXtakw4p4WJGWxwqTJvrYfkpDjlLWc7Vl3fRotg32ml32W5rSQVvfxW2N/aas6U9/TZ29pqZOZ1TPcGTD1eaGn78e6McFr/bbzwDvblGqLfPOrt7sGBx2DFVvKVm0ugIvGqhTashtdU0H24tx/Iye4hMgXMkzxu7HGHagJpBbtf0E108fOe6YSoYy1oVP4/1qy3KzZbHccLG+5XSxZLW+5nx7w3R+xmr7ieu7b1xtvnD18SvXt/csLy/5sP7M5eaOi/UNwgloaz30ns9fk/Uwg7rXW9cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Alt text\"\n        title=\"\"\n        src=\"/static/5955795ad6824d3c177659ac0794b4c8/5ff7e/image-1.png\"\n        srcset=\"/static/5955795ad6824d3c177659ac0794b4c8/c26ae/image-1.png 158w,\n/static/5955795ad6824d3c177659ac0794b4c8/6bdcf/image-1.png 315w,\n/static/5955795ad6824d3c177659ac0794b4c8/5ff7e/image-1.png 375w\"\n        sizes=\"(max-width: 375px) 100vw, 375px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","frontmatter":{"title":"Gatsby 목차 사이드바 만들기","date":"September 29, 2023","description":null,"tags":["gatsby","blog","react"]},"tableOfContents":"<ul>\n<li><a href=\"#%EB%8F%99%EA%B8%B0\">동기</a></li>\n<li><a href=\"#tableofcontents-%EC%BF%BC%EB%A6%AC\">tableOfContents 쿼리</a></li>\n<li><a href=\"#%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EC%A0%9C%EC%9E%91\">컴포넌트 제작</a></li>\n<li><a href=\"#%EA%BE%B8%EB%AF%B8%EA%B8%B0\">꾸미기</a></li>\n<li><a href=\"#%ED%98%84%EC%9E%AC-%EC%9D%BD%EA%B3%A0-%EC%9E%88%EB%8A%94-%EB%82%B4%EC%9A%A9-%ED%95%98%EC%9D%B4%EB%9D%BC%EC%9D%B4%ED%8A%B8-%ED%95%98%EA%B8%B0\">현재 읽고 있는 내용 하이라이트 하기</a></li>\n</ul>"},"previous":{"fields":{"slug":"/algorithms/백준-30024/"},"frontmatter":{"title":"백준 30024","date":"September 21, 2023"}},"next":{"fields":{"slug":"/computer-network/네트워크-레이어-(1)/"},"frontmatter":{"title":"네트워크 레이어 (1)","date":"October 06, 2023"}}},"pageContext":{"id":"37fe296b-6720-5d06-9b54-4e2d9b6f98f8","previousPostId":"0d9189b7-edde-5736-88c2-be6fa6be6a64","nextPostId":"e3648d63-0812-58de-917b-2b45f4fad1a1"}},"staticQueryHashes":["230163734","3589320610"],"slicesMap":{}}